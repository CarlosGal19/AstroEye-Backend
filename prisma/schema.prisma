generator client {
  provider = "prisma-client-js"
  output   = "./generated"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Site {
  siteId    Int      @id @default(autoincrement()) @map("site_id")
  name      String
  imageUrl  String   @map("image_url")
  createdAt DateTime @default(now()) @map("created_at")
  points    Point[]

  @@map("site")
}

model Category {
  categoryId Int      @id @default(autoincrement()) @map("category_id")
  name       String
  createdAt  DateTime @default(now()) @map("created_at")
  images     Image[]

  @@map("category")
}

model Image {
  imageId         Int      @id @default(autoincrement()) @map("image_id")
  previewImageUrl String   @map("preview_image_url")
  fullImageUrl    String   @map("full_image_url")
  title           String
  description     String   @db.Text
  aiDescription   String?  @db.Text
  categoryId      Int      @map("category_id")
  pointId         Int?     @unique @map("point_id")
  createdAt       DateTime @default(now()) @map("created_at")
  category        Category @relation(fields: [categoryId], references: [categoryId])
  point           Point?   @relation(fields: [pointId], references: [pointId])

  @@index([categoryId], map: "image_category_id_fkey")
  @@map("image")
}

model Point {
  pointId   Int      @id @default(autoincrement()) @map("point_id")
  siteId    Int      @map("site_id")
  latitude  Decimal  @db.Decimal(10, 8)
  longitude Decimal  @db.Decimal(11, 8)
  createdAt DateTime @default(now()) @map("created_at")
  image     Image?
  site      Site     @relation(fields: [siteId], references: [siteId])

  @@index([siteId], map: "point_site_id_fkey")
  @@map("point")
}
